
! seurat, signac dep


install.packages("devtools")
devtools::install_github("timoast/signac")


! user-specified subset of cells
    input would be i) a list of barcodes (selected because of whatever)
    and ii) the fragments file (same as in cellATAC). The output would
    be the peaks_matrix, as in cellATAC. The steps, 1) do macs2
    considering only the input barcodes, 2) do bed coverage and 3)
    build matrix
    (example: zoom e.g.on single or few clusters, consider
    everything jointly)
  ->  publish demux data in main pipeline
  ->  how long does it actually take / how big is the data;

! extract-features/merge-multiplets split pairs; join them?

o integrate multiple experiments


- merge-multiplets docopt dep

- publish merge-multiplets images.

- bedpe format Ni (three columns) versus more columns; instrumenting macs2 currently with -f AUTO.
  depth available-from-data / presented-to-macs2 / used-by-macs2 ?



s.a. only clusters based on windows, not on peaks


- Perhaps get rid of the bucket structure; it is no longer needed given that we demultiplex
  in the pipeline rather than outside, and given that we divide the cells into batches.
  However, it works and might become useful if the number of cells grow very large; we
  keep it for now.

- check
  clusters_makebam_P4
  We make bed file for macs2 where all features are on the positive strand.
  Any issue with this?
  Test whether macs2 picks up depth. Maybe ask even.

- devel
  when combining multiple samples, they need to use the same regions.
  Currently regions are derived from samtools view -H on the possorted bam file.

- devel
  produce mmtx format in mcxdump internally

- potentially streaming etc format is a wee bit faster. Very low priority.

- explicit outputs in matrixmarket creation (generally hardcoded names).
  Most of this is fixed now, except for the final bc/peak matrices.

- -c argument to cellatac script; check/select only the files that are there,
  i.e.  cope with drop-outs. currently expects all cells/barcodes to succeed.
  need to comapre with cov.inputs. do we just generate empt rows/columns in that
  case, or will something actually crash? Engineer test.  check more generally in
  the pipeline that it is permissive this way.

- layer docker file?
    need mcl and datamash on top of R image.

